module.exports=function(){var a=2,t=1.25,r=.75,e=100,n=60,o=30,i=2.5,c=10,s=0,f=100,l=300,p=.1,u=.1,h=.1,m=120,v=100,d=90,g=90,y=80,b=60,E=60,I=50,M=20,k=20,T=20,S=15,w=process.env.DEBUG;function O(){if(w){for(var a="",t=0;t<arguments.length;t++)a+=arguments[t]+" ";console.log(a)}}var A=function(a){return a[0][0]===a[1][0]};function G(a,t){var r=t.concat(a);R(a),R(r);a[0];var e=a[a.length-1],n=function(a){var t={};a.forEach(function(a){t[N(a)]=1,"A"===a[0]&&(t[1]=1)}),t=(t=Object.keys(t).map(function(a){return parseInt(a,10)})).sort(function(a,t){return a-t});for(var r=7,e=0;e<t.length;e++)if(!(t-e<2)){var n=t[e+1]-t[e];if(n<=4&&(r=Math.min(r,3)),!(t-e<3)){var o=t[e+2]-t[e];if(o<=4&&(r=Math.min(r,2)),!(t-e<4)){var i=t[e+3]-t[e];if(i<=4&&(r=Math.min(r,1)),!(t-e<5)){var c=t[e+4]-t[e];c<=4&&(r=Math.min(r,0))}}}}if(0===r)return 1;return-r}(r),o=function(a){var t={},r=!1,e=0;if(a.forEach(function(a){var n=a[1];t[n]=(t[n]||0)+1,t[n]>=5&&(r=!0),e=Math.max(e,t[n])}),r)return 1;return-(5-e)}(r),i=function(a){var t=[];a.forEach(function(a){var r=N(a);t[r]=(t[r]||0)+1});var r=[];return t.forEach(function(a,t){a>=1&&r.push({value:t,count:a})}),r.reverse(),r}(r),c=0,s=0,f=0;i.forEach(function(a){2===a.count&&c++,3===a.count&&s++,4===a.count&&f++});var l=-3;c&&(l=-2),s&&(l=-1),c>1&&(l=-1),s&&c&&(l=1);var p={straight:n,flush:o,sameCards:i,foak:f>0,toak:s>0,pair:c>0,highcard:r[r.length-1],lowcard:r[0],lowpair:0,topcard:!1,botcard:!1,fullhouse:l>0?1:l},u=!1;return t.length>1&&(e&&(A(t)&&(N(t[0])>N(e)&&(p.overpair=!0),i.forEach(function(a){a.value>N(t[0])&&(p.lowpair+=1)}),a.length<5&&(p.lowpair+=.5*(5-a.length))),N(e)!==N(t[0])&&N(e)!==N(t[1])||(p.toppair=!0),(N(e)<=N(t[0])||N(e)<=N(t[1]))&&(p.topcard=!0)),A(t)&&(i.forEach(function(a){a.value===N(t[0])&&a.count>2&&(u=!0)}),u&&(p.setpair=!0))),p}function N(a){return"T"===(a=a[0])?10:"J"===a?11:"Q"===a?12:"K"===a?13:"A"===a?14:+a}function R(a){a.sort(function(a,t){return N(a)-N(t)})}var P=function(a){var t=0;return a.forEach(function(a){t+=a.wagered}),t},_=function(a){R(a);var t=A(a),r=a[0][0]+a[1][0];return t&&"AK".match(a[0][0])?100:t&&"QJ".match(a[0][0])?90:t&&"T".match(a[0][0])?70:"KA"===r?90:"TJQKA".match(r)?50:0};function C(a){var t=0,r=G(a.community,[]),e=G(a.community,a.self.cards);switch(r.straight){case 0:case 1:t+=b;break;case-1:case-2:t+=b-M}switch(r.flush){case 0:case 1:t+=E;break;case-1:case-2:t+=E-M}switch(r.fullhouse){case 0:case 1:t+=I;break;case-1:case-2:t+=I-M}return t||(r.pair&&(t+=k),r.toak&&(t+=k),r.foak&&(t+=k),N(e.highcard)<=4&&!e.topcard&&(t+=T),N(e.highcard)<=6&&!e.topcard&&(t+=T),N(e.highcard)<=10&&!e.topcard&&(t+=T)),e.lowpair&&(t+=S*e.lowpair),t}function K(a,t){var r=G(a,t);if(r.straight>0||r.flush>0){var e=G(a,[]);if(Math.abs(e.straight)>=2&&Math.abs(e.flush)>=2)return m}return r.foak||r.fullhouse>0?v:r.straight>0||r.flush>0?d:r.overpair||r.setpair?g:r.toppair?y:0}var L={};var x={};function H(a){var t={payout:0,risk:0,post:0,pre:0,luck:0,actions:0,folds:0};if(pname="string"==typeof a?a:a.name,!L[pname])return t;var r=x[pname]||t;t=r;for(var e=r.actions;e<L[pname].length;e++){var n=L[pname][e];t.actions+=1,n.payout&&(t.payout+=n.payout,n.risk&&(t.luck+=n.payout/(n.risk||1))),n.folded&&(t.folds+=1),n.post&&(t.post+=n.post,t.risk+=n.risk),n.pre_ratio&&(t.pre+=n.pre_ratio||0)}return Object.keys(t).forEach(function(a){t[a]=Math.round(100*t[a])/100}),x[pname]=t,t}var U={};return{update:function(m){var v=0;switch(m.state){case"pre-flop":case"flop":case"turn":case"river":if((v="pre-flop"===m.state?function(t){var r=0;A(t.self.cards)&&t.betting.call<t.self.chips/12&&(r=t.betting.call);var e=_(t.self.cards),n=0;t.self.actions["pre-flop"]&&t.self.actions["pre-flop"].length&&(n+=1);var o=!1;e>=90&&!n?r=2*a*P(t.players):e>=70?r=a*P(t.players):e>=50?!n&&t.betting.raise<t.self.chips/4?r=t.betting.raise:t.betting.call<t.self.chips/12&&(r=t.betting.call):t.self.position>=t.players.length-1&&!n&&t.betting.call<f&&t.betting.call<t.self.chips/12&&(r=4*t.betting.call,o=!0);var i=!1;r&&t.betting.call>=l&&e<90&&t.players.forEach(function(a){var n=H(a);if(n.actions>100&&a.wagered>=30&&n.pre/n.actions>5){var o=h*P(t.players);e>70&&t.betting.call<t.self.chips/4&&(o=t.betting.call),O("MITIGATING PRE SHOVE",r,a.name,Math.min(o,r)),i=!0,r=Math.min(o,r)}});var c="***";return o&&(c="ddd"),r<t.betting.call&&(c="fff"),i&&(c=c[0]+"m"+c[2]),O(c,"PreFlop",t.state,t.self.cards,"SCORE",e,"POT",P(t.players),"BET",r,"POSITION",t.self.position,c),r}(m):function(f){var m=0,v=_(f.self.cards),d=K(f.community,f.self.cards),g=C(f),y=!1,b=d,E=function(a,t){return function(a,t,r){var e={};return a.players.forEach(function(n){if(n.position!=a.self.position&&n.name!==a.self.name){var o=["pre-flop","flop","turn","river"];r&&(o=[r]),o.forEach(function(a){var r=n.actions[a];r&&r.forEach(function(a){a&&a.type===t&&(e[n.name]=e[n.name]||0,e[n.name]+=1)})})}}),e}(a,"raise",t)}(f,f.state);d&&!U[f.hand]||(E.length||(d=100),U[f.hand]=!0,y=!0),d-g>=e?m=a*P(f.players):d-g>=n?m=t*P(f.players):b-g>=o&&(m=r*P(f.players));var I=!1;Object.keys(E).forEach(function(a){if(!I){var t=H(a);if(t.actions>100){var r=t.pre/t.actions>5,e=t.folds/t.actions>2,n=t.post/t.risk,o=t.luck/t.actions*100>c||t.luck/t.actions*100<s;if(n>=i){var l=u*P(f.players);O("MITIGATING RISK",m,a,Math.min(l,m)),I=!0,m=Math.min(l,m)}else o&&r&&(l=p*P(f.players),O("MITIGATING LUCK",m,a,Math.min(l,m)),I=!0,m=Math.min(l,m));!e&&f.self.position<=1&&v<70&&b-g<=30&&(l=p*P(f.players),O("MITIGATING BLIND",m,a,Math.min(l,m)),I=!0,m=Math.min(m,l))}}}),b-g<=30&&m>l&&f.players.forEach(function(a){if(!I&&"active"==a.state){var t=H(a);if(t.pre/t.actions>5&&f.betting.call>f.self.chips/8){var r=h*P(f.players);O("MITIGATING POST SHOVE",m,a.name,r),m=Math.min(r,m)}}});var M="***";return y&&(M="bbb"),0==m&&(M="xxx"),m<f.betting.call&&(M="fff"),I&&(M=M[0]+"m"+M[2]),O(M,"PostFlop",f.state,f.self.cards,f.community,"HS",b,"SCORE",d,"RISK",g,"POT",P(f.players),"BET",m,M),m}(m))>0){var d="RAISING";v===m.betting.call&&(d="CALLING"),v<m.betting.call&&(d="FOLDING"),v>100&&O("***",d,v,"CHIPS:",m.self.chips,"***")}}return"complete"===m.state&&function(a){var t=[];a.players.forEach(function(r){L[r.name]=L[r.name]||[],r.payout>0&&t.push({name:r.name,payout:r.payout,cards:r.cards});var e={};e.community=C(a),e.wagered=r.wagered+r.blind,e.payout=r.payout,e.folded="folded"==r.state,r.cards&&(e.pre=_(r.cards),e.post=K(a.community,r.cards),e.risk=e.post-e.community,e.bet_pre=0,r.actions["pre-flop"]&&(r.actions["pre-flop"].forEach(function(a){"fold"!=a.type&&(e.bet_pre+=a.bet||0)}),e.bet_pre>50&&(e.pre_ratio=e.bet_pre/(e.pre||1))),e.bet_post=e.wagered-e.bet_pre),L[r.name].push(e)}),O(a.hand,"WINNERS",JSON.stringify(t),a.community)}(m),100!==m.hand&&0!=m.self.chips||(0==m.self.chips&&O("LOST THE TOURNEY"),function(a){O("\nSUMMARY");var t={};a.players.sort(function(a,r){return t[a.name]||(t[a.name]=H(a)),t[r.name]||(t[r.name]=H(r)),t[r.name].payout-t[a.name].payout}),a.players.forEach(function(a){var r=t[a.name];r.payout&&O(a.name.slice(0,5)+"\tACT",r.actions,"\t\tPYT",r.payout,"\t\tSRS",Math.round(r.post/r.risk*100),"\t\tLUCKY?",Math.round(r.luck/r.actions*100),"\t\tPRE",r.pre/r.actions)}),O("")}(m)),v},info:{name:"aragorn",email:"",btcWallet:""}}};